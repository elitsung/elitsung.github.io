<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ page.title }}{% if page.title %} · {% endif %}{{ site.title }}</title>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    @keyframes wiggle {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(2deg); }
      50% { transform: rotate(-2deg); }
      75% { transform: rotate(1deg); }
    }
    body { 
      font-family: "IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      max-width: 900px;
      margin: 2rem auto;
      line-height: 1.6;
      background-color: #fff;
      color: #111;
    }
    a { 
      color: blue; 
      text-decoration: underline;
     }
    nav ul { 
      list-style: disc; 
      padding-left: 1.25rem;
     }
    header h1 { 
      margin-bottom: 0.5rem; 
      font-weight: 500; 
    }
    header h1 a {
      color: blue;
      text-decoration: underline;
      font-style: normal;
      transition: font-style 0.1s ease;
    }
    img { 
      max-width: 100%; 
      height: auto; 
    }
    figure { 
      margin: 0 0 2rem 0; 
    }
    figcaption { 
      font-size: 0.9em; 
      opacity: 0.7; 
    }
    header h1 a:hover,
    .page-divider {
      border: none;
      border-top: 1px solid rgba(0, 0, 0, 0.15);
      margin: 1.5rem auto 2rem auto;
      width: 100%;
    }
    /* LEFT align the bar */
    .nav-inline{
      text-align:left;              /* was center */
      margin-top:.5rem;
      font-size:1rem;
      letter-spacing:.3px;
      color:blue;
    }

    /* Links + hover */
    .nav-inline a{ color:blue; text-decoration:underline; font-style:normal; transition:font-style .1s ease; }
    .nav-inline a:hover{ text-decoration:none; font-style:italic; }

    /* Separator */
    .nav-inline .sep{ color:blue; margin:0 .35rem; }

    /* TREE BEHAVIOR */
    .nav-inline details{ display:inline; position:relative; }           /* inline on the top line */
    .nav-inline details > summary{ list-style:none; display:inline; cursor:pointer; }
    .nav-inline details > summary::-webkit-details-marker{ display:none; }

    /* When a tree is OPEN, move the whole details block to its own line so the subtree drops DOWN */
    .nav-inline details[open]{ display:block; margin-top:.35rem; }

    /* Subtree block (downward) */
    .nav-inline details[open] > ul{
      margin:.25rem 0 .6rem 1.25rem;   /* indent */
      padding-left:.75rem;
      border-left:1px solid rgba(0,0,0,.15);  /* the vertical “tree” line */
      text-align:left;
      color:blue;
    }
    .nav-inline ul{ margin:0; padding:0; }
    .nav-inline li{ list-style:none; margin:.25rem 0; }
    #nav-tree-container {
      margin-top: .75rem;
      margin-left: 1.25rem;
    }
    .subtree {
      padding-left: 1rem;
      border-left: 1px solid rgba(0,0,0,.15);
    }
    .subtree a {
      color: blue;
      text-decoration: underline;
    }
    .subtree a:hover {
      font-style: italic;
      text-decoration: none;
    }
  </style>
</head>
<body>

  {% if page.banner_image %}
  <div class="banner-image">
    <img src="{{ page.banner_image }}" alt="">
    {% if page.banner_text %}
      <div class="banner-text">{{ page.banner_text }}</div>
    {% endif %}
  </div>
  {% endif %}

  <header>
    <h1><a href="/">{{ site.title }}</a></h1>
    <nav class="nav-inline">
      {% for item in site.data.nav %}
        <span class="nav-item">{% include tree_item.html item=item %}</span>
        {% unless forloop.last %}<span class="sep"> ✱ </span>{% endunless %}
      {% endfor %}
    </nav>
    <div id="nav-tree-container"></div>
  </header>
  <hr class="page-divider">
  <main>
    {{ content }}
  </main>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const treeContainer = document.getElementById('nav-tree-container');
  const navItems = document.querySelectorAll('.nav-root');

  const navData = {{ site.data.nav | jsonify }};

  function buildTree(children) {
    return `
      <ul class="subtree">
        ${children.map(child => `
          <li>
            <a href="${child.url}">${child.title}</a>
            ${child.children ? buildTree(child.children) : ''}
          </li>
        `).join('')}
      </ul>
    `;
  }

  navItems.forEach(item => {
    item.addEventListener('click', (e) => {
      e.preventDefault();
      const title = item.getAttribute('data-children');
      const node = navData.find(n => n.title.toLowerCase() === title);
      if (node && node.children) {
        treeContainer.innerHTML = buildTree(node.children);
      } else {
        treeContainer.innerHTML = '';
      }
    });
  });
});
</script>
</body>
</html>